<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoChat AI | Deep Research Intelligence</title>
    <meta name="description"
        content="NeoChat AI - World-class AI Chatbot with deep research capabilities powered by GPT-OSS-120B and Tavily">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Three.js for 3D effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <!-- Marked.js for Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Prism.js for Code Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>

    <!-- jsPDF for PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- KaTeX for Math Rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Firebase SDK (CDN) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'neo-dark': '#010101',
                        'neo-purple': '#8B5CF6',
                        'neo-cyan': '#06B6D4',
                        'neo-pink': '#EC4899',
                        'neo-blue': '#3B82F6',
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-neo-dark min-h-screen overflow-hidden font-sans">
    <!-- Three.js Canvas Container -->
    <div id="three-container" class="fixed inset-0 z-0"></div>

    <!-- Crystal Orb Container -->
    <div id="orb-container" class="fixed bottom-8 right-8 w-40 h-40 z-10 pointer-events-none"></div>

    <!-- Main Application -->
    <div class="relative z-20 flex h-screen">

        <!-- Sidebar - Chat History -->
        <aside id="sidebar" class="w-72 glass-panel border-r border-white/10 flex flex-col">
            <!-- Logo -->
            <div class="p-5 border-b border-white/10">
                <div class="flex items-center gap-3">
                    <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-br from-neo-purple to-neo-cyan flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M13 10V3L4 14h7v7l9-11h-7z" />
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-white">NeoChat</h1>
                        <span class="text-xs text-neo-cyan">AI</span>
                    </div>
                </div>
            </div>

            <!-- New Chat Button -->
            <div class="p-4">
                <button id="new-chat-btn"
                    class="w-full py-3 px-4 rounded-xl neon-border-purple bg-white/5 hover:bg-white/10 transition-all text-white font-medium flex items-center gap-3">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    New Chat
                </button>
            </div>

            <!-- Chat History List -->
            <div class="flex-1 overflow-y-auto px-4 space-y-2" id="chat-history-list">
                <!-- Chat history items will be populated by JS -->
            </div>

            <!-- Sidebar Footer -->
            <div class="p-4 border-t border-white/10 space-y-3">
                <!-- User Info -->
                <div id="user-info" class="flex items-center gap-3 p-2 rounded-lg bg-white/5">
                    <div
                        class="w-8 h-8 rounded-full bg-gradient-to-br from-neo-purple to-neo-blue flex items-center justify-center text-white text-sm font-bold">
                        <span id="user-avatar">U</span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p id="user-name" class="text-sm font-medium text-white truncate">User</p>
                        <p id="user-email" class="text-xs text-gray-500 truncate">email@example.com</p>
                    </div>
                </div>

                <button id="policy-btn"
                    class="w-full text-left p-2 rounded-lg hover:bg-white/5 transition-colors text-gray-400 hover:text-white text-sm flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Usage Policy
                </button>

                <button onclick="logoutUser()"
                    class="w-full text-left p-2 rounded-lg hover:bg-red-500/10 transition-colors text-gray-400 hover:text-red-400 text-sm flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    Logout
                </button>

                <div class="text-xs text-gray-500 text-center pt-2 border-t border-white/5">
                    Powered by NeoChat AI
                </div>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <main class="flex-1 flex flex-col relative">

            <!-- Verification Warning Banner -->
            <div id="verification-banner" class="hidden bg-yellow-500/20 border-b border-yellow-500/30 p-2 text-center">
                <p class="text-sm text-yellow-200">
                    ‚ö†Ô∏è Your email address is not verified.
                    <button onclick="resendVerificationEmail()" class="underline hover:text-white font-semibold ml-2">
                        Resend Verification Email
                    </button>
                </p>
            </div>

            <!-- Chat Header -->
            <header class="glass-panel border-b border-white/10 p-4 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <h2 id="current-chat-title" class="text-white text-lg font-medium">New Conversation</h2>

                    <!-- Model Selector Dropdown -->
                    <div class="relative">
                        <select id="model-selector"
                            class="appearance-none bg-neo-purple/20 border border-neo-purple/30 text-neo-purple text-xs px-3 py-1.5 pr-8 rounded-full cursor-pointer focus:outline-none focus:border-neo-purple/50 hover:bg-neo-purple/30 transition-colors">
                            <option value="gpt-oss-safeguard-20b">‚ö° GPT-OSS 20B</option>

                            <option value="kimi-k2">üß† Kimi K2</option>
                            <option value="llama-4-scout">üëÅÔ∏è Llama 4 Scout (Vision)</option>
                            <option value="qwen3-32b">üí≠ Qwen3 32B (Thinking)</option>
                        </select>
                        <svg class="w-3 h-3 absolute right-2.5 top-1/2 -translate-y-1/2 text-neo-purple pointer-events-none"
                            fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </div>

                    <!-- Persona Selector Dropdown -->
                    <div class="relative">
                        <select id="persona-selector"
                            class="appearance-none bg-neo-cyan/20 border border-neo-cyan/30 text-neo-cyan text-xs px-3 py-1.5 pr-8 rounded-full cursor-pointer focus:outline-none focus:border-neo-cyan/50 hover:bg-neo-cyan/30 transition-colors">
                            <option value="default">üß† Default</option>
                            <option value="coder">üë®‚Äçüíª Coder</option>
                            <option value="creative-writer">‚úçÔ∏è Creative Writer</option>
                            <option value="health-advisor">üíä Health Advisor</option>
                        </select>
                        <svg class="w-3 h-3 absolute right-2.5 top-1/2 -translate-y-1/2 text-neo-cyan pointer-events-none"
                            fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </div>
                </div>

                <!-- Deep Research Toggle -->
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-3">
                        <span class="text-gray-400 text-sm">Deep Research</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="deep-research-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Export Button -->
                    <button id="export-btn"
                        class="p-2 rounded-lg hover:bg-white/10 transition-colors text-gray-400 hover:text-white"
                        title="Export as PDF">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Messages Container -->
            <div id="messages-container" class="flex-1 overflow-y-auto p-6 space-y-6">
                <!-- Welcome Message -->
                <div class="flex justify-center items-center h-full" id="welcome-screen">
                    <div class="text-center max-w-2xl">
                        <div
                            class="w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-neo-purple via-neo-cyan to-neo-pink p-0.5 animate-pulse-glow">
                            <div class="w-full h-full rounded-2xl bg-neo-dark flex items-center justify-center">
                                <svg class="w-10 h-10 text-neo-cyan" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                </svg>
                            </div>
                        </div>
                        <h2 class="text-3xl font-bold text-white mb-3">Welcome to NeoChat AI</h2>
                        <p class="text-gray-400 mb-8">Your intelligent research assistant powered by GPT-OSS-120B with
                            deep web research capabilities.</p>
                        <div class="grid grid-cols-3 gap-4 text-left">
                            <div class="glass-card p-4 rounded-xl cursor-pointer hover:border-neo-purple/50 transition-colors"
                                onclick="setExamplePrompt('Explain quantum computing in simple terms')">
                                <div class="text-neo-purple mb-2">üí°</div>
                                <div class="text-sm text-gray-300">Explain quantum computing in simple terms</div>
                            </div>
                            <div class="glass-card p-4 rounded-xl cursor-pointer hover:border-neo-cyan/50 transition-colors"
                                onclick="setExamplePrompt('What are the latest AI breakthroughs in 2024?')">
                                <div class="text-neo-cyan mb-2">üî¨</div>
                                <div class="text-sm text-gray-300">What are the latest AI breakthroughs?</div>
                            </div>
                            <div class="glass-card p-4 rounded-xl cursor-pointer hover:border-neo-pink/50 transition-colors"
                                onclick="setExamplePrompt('Write a Python script to analyze stock data')">
                                <div class="text-neo-pink mb-2">üíª</div>
                                <div class="text-sm text-gray-300">Write a Python script to analyze data</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Messages will be inserted here -->
            </div>

            <!-- Truth-Meter Gauge -->
            <div id="truth-meter-container" class="hidden absolute top-20 right-6 glass-card p-4 rounded-xl w-48">
                <div class="text-xs text-gray-400 mb-2 text-center">Confidence Score</div>
                <div class="truth-meter-gauge">
                    <svg viewBox="0 0 100 60" class="w-full">
                        <defs>
                            <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#EF4444" />
                                <stop offset="50%" style="stop-color:#F59E0B" />
                                <stop offset="100%" style="stop-color:#10B981" />
                            </linearGradient>
                        </defs>
                        <!-- Background arc -->
                        <path d="M 10 50 A 40 40 0 0 1 90 50" fill="none" stroke="rgba(255,255,255,0.1)"
                            stroke-width="8" stroke-linecap="round" />
                        <!-- Gauge arc -->
                        <path id="gauge-arc" d="M 10 50 A 40 40 0 0 1 90 50" fill="none" stroke="url(#gaugeGradient)"
                            stroke-width="8" stroke-linecap="round" stroke-dasharray="0, 126" />
                        <!-- Needle -->
                        <line id="gauge-needle" x1="50" y1="50" x2="50" y2="15" stroke="#fff" stroke-width="2"
                            stroke-linecap="round" transform="rotate(-90, 50, 50)" />
                    </svg>
                    <div id="confidence-value" class="text-2xl font-bold text-white text-center">0%</div>
                </div>
            </div>

            <!-- Chat Input Area -->
            <div class="p-6 border-t border-white/10">
                <div class="max-w-4xl mx-auto">
                    <div class="chat-input-container">
                        <div class="flex items-end gap-3">
                            <!-- File Upload -->
                            <button id="file-btn"
                                class="p-3 rounded-xl hover:bg-white/10 transition-colors text-gray-400 hover:text-white"
                                title="Upload File">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                                </svg>
                            </button>
                            <input type="file" id="file-input" class="hidden" accept="*/*">

                            <!-- Voice Input -->
                            <button id="voice-btn"
                                class="p-3 rounded-xl hover:bg-white/10 transition-colors text-gray-400 hover:text-white"
                                title="Voice Input">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                                </svg>
                            </button>

                            <!-- Main Input -->
                            <div class="flex-1 relative">
                                <textarea id="chat-input" placeholder="Ask anything... or paste a URL to analyze"
                                    class="w-full bg-white/5 border border-white/10 rounded-2xl px-5 py-4 text-white placeholder-gray-500 focus:outline-none focus:border-neo-purple/50 resize-none transition-all"
                                    rows="1" style="max-height: 200px;"></textarea>
                            </div>

                            <!-- Send Button -->
                            <button id="send-btn"
                                class="p-4 rounded-2xl bg-gradient-to-r from-neo-purple to-neo-cyan text-white hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M14 5l7 7m0 0l-7 7m7-7H3" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="text-center mt-3 text-xs text-gray-500">
                        NeoChat AI can make mistakes. Verify important information.
                    </div>
                </div>
            </div>
        </main>

        <!-- Thinking Logs Side Panel -->
        <aside id="thinking-logs-panel" class="w-80 glass-panel border-l border-white/10 hidden flex-col">
            <div class="p-4 border-b border-white/10">
                <h3 class="text-white font-medium flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full bg-neo-cyan animate-pulse"></div>
                    Thinking Logs
                </h3>
            </div>
            <div id="thinking-logs" class="flex-1 overflow-y-auto p-4 space-y-2 font-mono text-xs">
                <!-- Logs will be inserted here -->
            </div>
        </aside>
    </div>

    <!-- Deep Research Confirmation Modal -->
    <div id="deep-research-modal" class="fixed inset-0 z-50 hidden bg-black/80 flex items-center justify-center">
        <div
            class="glass-card p-6 rounded-2xl max-w-sm w-full mx-4 border border-neo-cyan/30 shadow-[0_0_30px_rgba(6,182,212,0.2)]">
            <div class="text-center mb-6">
                <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-neo-cyan/20 flex items-center justify-center">
                    <svg class="w-8 h-8 text-neo-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-white mb-2">Switch to Llama 4 Scout?</h3>
                <p class="text-gray-300 text-sm">
                    Deep Research requires the high-speed <span class="text-neo-cyan font-bold">Llama 4 Scout</span>
                    model to analyze detailed information.
                    <br><br>
                    Do you want to use this model?
                </p>
            </div>
            <div class="flex gap-3">
                <button id="cancel-research-btn"
                    class="flex-1 py-2 px-4 rounded-xl border border-white/10 text-gray-300 hover:bg-white/5 transition-colors text-sm font-medium">
                    Decline
                </button>
                <button id="confirm-research-btn"
                    class="flex-1 py-2 px-4 rounded-xl bg-gradient-to-r from-neo-cyan to-neo-blue text-white hover:opacity-90 transition-opacity text-sm font-medium">
                    Accept
                </button>
            </div>
        </div>
    </div>

    <!-- Deep Research Disable Modal -->
    <div id="deep-research-disable-modal"
        class="fixed inset-0 z-50 hidden bg-black/80 flex items-center justify-center">
        <div
            class="glass-card p-6 rounded-2xl max-w-sm w-full mx-4 border border-red-500/30 shadow-[0_0_30px_rgba(239,68,68,0.2)]">
            <div class="text-center mb-6">
                <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20 flex items-center justify-center">
                    <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-white mb-2">Disable Deep Research?</h3>
                <p class="text-gray-300 text-sm">
                    Turning off Deep Research will start a <span class="text-red-400 font-bold">New Chat</span>.
                    <br><br>
                    Are you sure?
                </p>
            </div>
            <div class="flex gap-3">
                <button id="cancel-disable-btn"
                    class="flex-1 py-2 px-4 rounded-xl border border-white/10 text-gray-300 hover:bg-white/5 transition-colors text-sm font-medium">
                    Cancel
                </button>
                <button id="confirm-disable-btn"
                    class="flex-1 py-2 px-4 rounded-xl bg-gradient-to-r from-red-600 to-red-500 text-white hover:opacity-90 transition-opacity text-sm font-medium">
                    Disable & New Chat
                </button>
            </div>
        </div>
    </div>

    <!-- Voice Recording Overlay -->
    <div id="voice-overlay" class="fixed inset-0 z-50 hidden bg-black/80 flex items-center justify-center">
        <div class="text-center">
            <div
                class="w-32 h-32 mx-auto mb-6 rounded-full bg-gradient-to-br from-neo-purple to-neo-cyan animate-pulse flex items-center justify-center">
                class="w-32 h-32 mx-auto mb-6 rounded-full bg-gradient-to-br from-neo-purple to-neo-cyan animate-pulse
                flex items-center justify-center">
                <svg class="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                </svg>
            </div>
            <p class="text-white text-xl mb-4">Listening...</p>
            <button id="stop-voice-btn"
                class="px-6 py-3 rounded-xl bg-red-500 text-white hover:bg-red-600 transition-colors">
                Stop Recording
            </button>
        </div>
    </div>

    <!-- Usage Policy Modal -->
    <div id="policy-modal" class="fixed inset-0 z-50 hidden bg-black/90 flex items-center justify-center p-4">
        <div
            class="glass-card max-w-2xl w-full max-h-[80vh] flex flex-col rounded-2xl border border-white/10 shadow-2xl">
            <div class="p-6 border-b border-white/10 flex justify-between items-center bg-black/40 rounded-t-2xl">
                <h3 class="text-xl font-bold text-white flex items-center gap-2">
                    <svg class="w-6 h-6 text-neo-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                    Usage Policy
                </h3>
                <button id="close-policy-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6 overflow-y-auto text-gray-300 space-y-4 text-sm leading-relaxed">
                <p class="font-bold text-white">We aim for our tools to be used safely and responsibly.</p>

                <h4 class="text-neo-cyan font-bold mt-4">1. Protect People</h4>
                <p>You cannot use our services for:</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li>Threats, intimidation, harassment, or defamation.</li>
                    <li>Promoting self-harm, violence, or terrorism.</li>
                    <li>Sexual violence or non-consensual content.</li>
                    <li>Illegal acts or developing weapons.</li>
                </ul>

                <h4 class="text-neo-cyan font-bold mt-4">2. Respect Privacy</h4>
                <p>We do not allow:</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li>Compromising others' privacy or distributing sensitive info.</li>
                    <li>Facial recognition or biometric identification without consent.</li>
                    <li>Inferring sensitive attributes or emotions without cause.</li>
                </ul>

                <h4 class="text-neo-cyan font-bold mt-4">3. Keep Minors Safe</h4>
                <p>Strictly prohibited:</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li>Any form of Child Sexual Abuse Material (CSAM).</li>
                    <li>Grooming or exposing minors to harmful content.</li>
                </ul>

                <h4 class="text-neo-cyan font-bold mt-4">4. Empower People</h4>
                <p>Do not use for:</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li>Deceit, fraud, scams, or impersonation.</li>
                    <li>Political interference or disinformation.</li>
                    <li>Automated high-stakes decisions (medical, legal, financial) without review.</li>
                </ul>

                <div class="mt-6 p-4 bg-white/5 rounded-xl border border-white/10">
                    <p class="text-xs text-gray-400 text-center">
                        Responsible use is a shared priority. Breaking these rules may result in loss of access.
                    </p>
                </div>
            </div>
            <div class="p-4 border-t border-white/10 bg-black/40 rounded-b-2xl text-right">
                <button id="policy-ok-btn"
                    class="px-6 py-2 bg-neo-cyan text-black font-bold rounded-lg hover:bg-neo-cyan/90 transition-colors">
                    I Understand
                </button>
            </div>
        </div>
    </div>

    <!-- Artifact Modal (Live Code Preview) -->
    <div id="artifact-modal" class="fixed inset-0 z-[60] hidden bg-black/90 flex items-center justify-center p-4">
        <div
            class="glass-card w-full max-w-5xl h-[85vh] flex flex-col rounded-2xl border border-neo-purple/30 shadow-[0_0_50px_rgba(139,92,246,0.2)] overflow-hidden">
            <!-- Modal Header -->
            <div class="p-4 border-b border-white/10 flex justify-between items-center bg-black/40">
                <div class="flex items-center gap-3">
                    <div
                        class="w-8 h-8 rounded-lg bg-gradient-to-br from-neo-purple to-neo-blue flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="text-white font-bold">Live Preview</h3>
                        <span class="text-xs text-neo-blue">Artifact Renderer</span>
                    </div>
                </div>
                <button id="close-artifact-btn"
                    class="p-2 rounded-lg hover:bg-white/10 text-gray-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- Preview Sandbox (Iframe) -->
            <div class="flex-1 bg-white relative">
                <iframe id="artifact-iframe" class="w-full h-full border-none"
                    sandbox="allow-scripts allow-modals allow-forms allow-popups allow-same-origin"></iframe>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Usage Policy Modal -->
    <div id="policy-modal" class="fixed inset-0 z-[70] hidden bg-black/90 flex items-center justify-center p-4">
        <div
            class="glass-card max-w-2xl w-full max-h-[80vh] flex flex-col rounded-2xl border border-white/10 shadow-2xl">
            <div class="p-6 border-b border-white/10 flex justify-between items-center bg-black/40 rounded-t-2xl">
                <h3 class="text-xl font-bold text-white flex items-center gap-2">
                    <svg class="w-6 h-6 text-neo-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                    Usage Policy
                </h3>
                <button id="close-policy-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6 overflow-y-auto text-gray-300 space-y-4 text-sm leading-relaxed">
                <p class="font-bold text-white">We aim for our tools to be used safely and responsibly.</p>

                <h4 class="text-neo-cyan font-bold mt-4">1. Protect People</h4>
                <p>You cannot use our services for:</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li>Threats, intimidation, harassment, or defamation.</li>
                    <li>Promoting self-harm, violence, or terrorism.</li>
                    <li>Sexual violence or non-consensual content.</li>
                    <li>Illegal acts or developing weapons.</li>
                </ul>

                <h4 class="text-neo-cyan font-bold mt-4">2. Respect Privacy</h4>
                <p>We do not allow:</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li>Compromising others' privacy or distributing sensitive info.</li>
                    <li>Facial recognition or biometric identification without consent.</li>
                    <li>Inferring sensitive attributes or emotions without cause.</li>
                </ul>

                <h4 class="text-neo-cyan font-bold mt-4">3. Keep Minors Safe</h4>
                <p>Strictly prohibited:</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li>Any form of Child Sexual Abuse Material (CSAM).</li>
                    <li>Grooming or exposing minors to harmful content.</li>
                </ul>

                <h4 class="text-neo-cyan font-bold mt-4">4. Empower People</h4>
                <p>Do not use for:</p>
                <ul class="list-disc pl-5 space-y-1">
                    <li>Deceit, fraud, scams, or impersonation.</li>
                    <li>Political interference or disinformation.</li>
                    <li>Automated high-stakes decisions (medical, legal, financial) without review.</li>
                </ul>

                <div class="mt-6 p-4 bg-white/5 rounded-xl border border-white/10">
                    <p class="text-xs text-gray-400 text-center">
                        Responsible use is a shared priority. Breaking these rules may result in loss of access.
                    </p>
                </div>
            </div>
            <div class="p-4 border-t border-white/10 bg-black/40 rounded-b-2xl text-right">
                <button id="policy-ok-btn"
                    class="px-6 py-2 bg-neo-cyan text-black font-bold rounded-lg hover:bg-neo-cyan/90 transition-colors">
                    I Understand
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Image Upload Modal -->
    <div id="image-upload-modal" class="fixed inset-0 z-[70] hidden bg-black/90 flex items-center justify-center p-4">
        <div class="glass-card max-w-md w-full rounded-2xl border border-neo-cyan/30 shadow-2xl">
            <div class="p-6 border-b border-white/10 flex items-center gap-4 bg-black/40 rounded-t-2xl">
                <div class="w-12 h-12 rounded-full bg-neo-cyan/20 flex items-center justify-center">
                    <svg class="w-6 h-6 text-neo-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                </div>
                <div>
                    <h3 class="text-lg font-bold text-white">Image Detected</h3>
                    <p id="image-filename" class="text-sm text-gray-400">filename.png</p>
                </div>
            </div>
            <div class="p-6 text-gray-300 text-sm">
                <p class="mb-4">To analyze images, you need to use:</p>
                <div class="flex items-center gap-3 p-3 bg-neo-cyan/10 rounded-xl border border-neo-cyan/20 mb-4">
                    <span class="text-2xl">üëÅÔ∏è</span>
                    <div>
                        <div class="font-bold text-white">Llama 4 Scout (Vision)</div>
                        <div class="text-xs text-gray-400">Only this model can see and analyze images</div>
                    </div>
                </div>
                <p class="text-gray-400">Do you want to switch to this model?</p>
            </div>
            <div class="p-4 border-t border-white/10 bg-black/40 rounded-b-2xl flex gap-3">
                <button id="cancel-image-btn"
                    class="flex-1 py-2 px-4 rounded-xl border border-white/10 text-gray-300 hover:bg-white/5 transition-colors text-sm font-medium">
                    Cancel
                </button>
                <button id="confirm-image-btn"
                    class="flex-1 py-2 px-4 rounded-xl bg-gradient-to-r from-neo-cyan to-neo-blue text-white hover:opacity-90 transition-opacity text-sm font-medium">
                    Switch & Upload
                </button>
            </div>
        </div>
    </div>

    <script src="js/three-scene.js"></script>
    <script src="js/groq-api.js"></script>
    <script src="js/tavily-api.js"></script>
    <script src="js/chat-ui.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/speech.js"></script>
    <script src="js/export.js"></script>
    <script src="js/app.js"></script>
</body>

</html>